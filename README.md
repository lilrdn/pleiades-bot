# Pleiades bot

Бот для проведения опросов в ВК. 
Написан на Python. 

[![Tests](https://github.com/avidale/pleiades-bot/actions/workflows/test_and_deploy.yaml/badge.svg?branch=master)](https://github.com/avidale/pleiades-bot/actions/workflows/test_and_deploy.yaml)

Форма анкет, которые предлагает заполнить бот, хранится в папке `data/forms`.

Подготовка: 
```pip install -r requirements.txt```

Локальный запуск (для теста в командной строке): 
```python main.py --cli```

Боевой запуск:
```python main.py```

Для работы с ВК предварительно нужно выставить переменные окружения:
- `VK_GROUP_ID` - id сообщества ВК
- `VK_TOKEN` - токен от сообщества ВК
    1. Зайти в настройки API в сообществе VK и потребовать ключ 
    с доступом к управлению (!) и сообщениям сообщества (https://vk.com/dev/access_token)
    1. В настройках сообщества "Сообщения > настройки для бота" разрешить бота
- `BASE_URL` - адрес сервера с ботом (нужен для установки вебхука ВК)

Кроме того, есть несколько необязательных переменных окружения
- `MONGODB_URI` - строка подключерния к БД 
 (чтобы бот сохранял состояние при перезапуске и результаты опросов)
- `SENTRY_DSN` - строка подключения к sentry (для мониторинга ошибок)
- `CODEWORD` - пароль для админского доступа к боту (для выгрузки результатов)
- Артём
- бббб
